<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- start of Google tag (gtag.js) -->
        <!-- tagmanager.google.com -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LECMLYN21B"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());
            gtag("config", "G-LECMLYN21B");
        </script>
        <!-- end of Google tag (gtag.js) -->

        <!-- start of Google Search Console Ownership verification -->
        <!-- search.google.com * search-console/ownership -->
        <meta name="google-site-verification" content="UqB5vtnZNIl-hvyiqwM0PDgX772rcbWWjt0g9onB_BQ" />
        <meta name="robots" content="index, follow" />
        <meta name="googlebot" content="notranslate" />
        <meta name="google" content="nopagereadaloud" />
        <!-- end of Google Search Console Ownership verification -->

        <!-- start of Google AdSense -->
        <!-- adsense.google.com/adsense -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5944204031363480" crossorigin="anonymous"></script>
        <!-- end of Google AdSense -->

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Compare Tool by Willy Horizont" />
        <meta name="keywords" content="Compare Tool by Willy Horizont" />
        <meta name="author" content="Willy Horizont" />
        <meta name="theme-color" content="#000000" />
        <link rel="icon" type="image/x-icon" href="../../favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png" />
        <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png" />
        <link rel="icon" type="image/png" sizes="192x192" href="../../android-chrome-192x192.png" />
        <link rel="icon" type="image/png" sizes="512x512" href="../../android-chrome-512x512.png" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png" />
        <link rel="stylesheet" href="../../style.css" />
        <title>Compare Tool | Portfolio | Willy Horizont</title>
        <script src="../../utils.js"></script>
        <script src="../../utils-web.js"></script>
    </head>
    <body>
        <header>
            <nav id="navbar" class="navbar">
                <a href="/" class="app-logo"><img src="../../android-chrome-192x192.png" alt="Willy Horizont's logo" width="48px" height="48px" />
                    <!-- <span>Willy Horizont</span> -->
                </a>
                <ul>
                    <li class="navbar-item"><a href="/">Home</a></li>
                    <li class="navbar-item-selected"><a href="/portfolio">Portfolio</a></li>
                    <li class="navbar-item"><a href="/cv">CV</a></li>
                    <li class="navbar-item"><a href="/links">Links</a></li>
                    <li class="navbar-item"><a href="/about">About</a></li>
                    <li class="navbar-item"><a href="/support">Support</a></li>
                    <li class="navbar-item"><a href="/contact">Contact</a></li>
                    <li class="navbar-item navbar-hamburger-menu-close-button" onclick="toggleMenu()">✖</li>
                </ul>
                <span id="navbar-hamburger-menu-button" class="navbar-hamburger-menu-button" onclick="toggleMenu()">&#9776;</span>
            </nav>
        </header>
        <main>
            <div class="portfolio-compare-tool" style="padding: 8px;">
                <div class="portfolio-compare-tool-container">
                    <h1 style="text-align: center;">Compare Tool</h1>
                    <div style="width: 100%; display: flex; flex-direction: column; overflow-x: auto;">
                        <div style="width: 100%; display: flex; flex-direction: column; margin: 8px 0px;">
                            <button onclick="addNewColumnKey()" style="align-self: center; cursor: pointer; width: fit-content; padding: 0.2em 0.4em; background-color: #007bff; color: #ccc; border: none; outline: none; white-space: nowrap;">+ column</button>
                        </div>
                        <div style="width: 100%; display: flex; flex-direction: column;">
                            <div id="compare-tool-items-container" style="display: flex; flex-direction: row; width: 100%; align-items: flex-start; overflow-x: auto;">
                            </div>
                        </div>
                    </div>
                    <div style="width: 100%; display: flex; flex-direction: column; margin: 8px 0px; justify-content: center; align-items: center;">
                        <div style="display: flex; flex-direction: column; min-width: 200px; max-width: 200px; background-color: #fff; justify-content: center; align-items: center; padding: 8px;">
                            <div style="display: flex; flex-direction: column; width: 100%; justify-content: center; align-items: center; border: 1px solid #000">
                                <p style="width: 100%; text-align: center; padding: 4px 8px; background-color: #091929; color: #fff;">Selected Column</p>
                                <p id="countainer-selected-column" data-selected-column="" style="width: 100%; text-align: center; padding: 4px 8px; background-color: #fff; color: #000; min-height: 26.4px;"></p>
                                <div style="width: 100%; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap: 8px; padding: 8px; border-top: 1px solid #000;">
                                    <button onclick="moveSelectedColumnToLeft()" style="background-color: #007bff; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">◀</button>
                                    <button onclick="moveSelectedColumnToRight()" style="background-color: #007bff; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">▶</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding: 4px; width: 100%; display: flex; flex-direction: column;">
                        <h2 style="margin-top: 8px;">Import & Export:</h2>
                        <textarea id="import-export-textarea-compare-tool" rows="4" cols="50" style="background-color: #000; color: #ccc; margin-top: 16px;" onblur="updateTextAreaContentToLocalStorageOnBlur(event)"></textarea>
                        <div id="error-message-container" style="margin-top: 8px;">
                        </div>
                    </div>
                </div>
                <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; margin-top: 16px;">
                    <div style="max-width: 50%; display: flex; flex-direction: row; justify-content: center; align-items: center; flex-wrap: wrap; gap: 16px;">
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://trakteer.id/p3thvx/link?open=true" target="_blank" aria-label="Trakteer">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="https://trakteer.id/favicon/favicon-32x32.png" alt="Trakteer's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Trakteer</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://saweria.co/p3thvx" target="_blank" aria-label="Saweria">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://saweria.co&client=VFE&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL&nfrp=2" alt="Saweria's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Saweria</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://sociabuzz.com/p3thvx" target="_blank" aria-label="Sociabuzz">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="https://storage.sociabuzz.com/storage/img/tribe/logo.png" alt="Sociabuzz's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Sociabuzz</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://www.nihbuatjajan.com/p3thvx" target="_blank" aria-label="Nih Buat Jajan">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRxp6o2dSrvX4XsYqykH8l5-APqtOuniis61Q&s" alt="Nih Buat Jajan's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Nih Buat Jajan</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://nyawer.co/p3thvx" target="_blank" aria-label="Nyawer">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="https://nyawer.co/favicon_io/favicon.ico" alt="Nyawer's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Nyawer</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div style="border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; flex-wrap: wrap;">
                            <a href="https://karyakarsa.com/p3thvx/support" target="_blank" aria-label="Karyakarsa">
                                <div style="display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 8px; flex-wrap: wrap; column-gap: 8px;">
                                    <p style="white-space: nowrap;">Support me via</p>
                                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAABEklEQVR4Ae3WgQbCQBwG8CWlF5hQMECGnqAABQUphgqIAlYAAj1B1CPEAgoIgukZ9gIVgKBRJf27jwZSV9d1yD4+wza/3d2O04p2SWnVgiFItc6MdfJhZ1RppURB+rjVdo9K9agakIPJBM/Agvd+De6DkckC+Vi5EeNiEsAzH5MJ8qdRHsj5QeSC/XTmqmlaVg24XNF4NKJIPH5iaPJ3YLNLwOhyIQQoAz2gksFHLIht25jaKVCp4HG+eMAQ3/c5qAA4zBVos17Ts+CeZVkHBg5YE1+DhmG8BBHP8wK0owREXNcl0zR3DM1/DWIEWK9XxRo7jkN4HqgwiP2m6/r2nWKEuN63S0IIxNcKNvm/p7YQvAHhLWgqT/E0/AAAAABJRU5ErkJggg==" alt="Karyakarsa's logo" width="16px" height="16px" />
                                        <p style="white-space: nowrap; margin-left: 4px;">Karyakarsa</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer>
            <p>Made with ❤️ by Willy Horizont</p>
        </footer>
        <script>
            function toggleMenu() {
                document.getElementById("navbar").classList.toggle("responsive");
            }

            const localStorageKey = "compare_tool_items";

            const updateTextAreaContentFromLocalStorage = (compareToolItemsData) => {
                const elementImportExportCompareToolItemsTextarea = document.getElementById("import-export-textarea-compare-tool");
                elementImportExportCompareToolItemsTextarea.value = ((compareToolItemsData === null) ? "" : JSON.stringify(compareToolItemsData));
            };

            const getCurrentDataCompareToolItems = () => {
                const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                let compareToolItemsData = Array.from(elementContainerCompareToolItems.children).map((elementCompareToolItem) => ({
                    "item_column_key": (elementCompareToolItem.dataset["itemColumnKey"] || ""),
                    "item_column_values": (elementCompareToolItem.dataset["currentItemColumnValues"] || ""),
                }));
                compareToolItemsData = ((compareToolItemsData.length === 0) ? null : compareToolItemsData);
                return compareToolItemsData;
            };

            const saveToLocalStorage = () => {
                const compareToolItemsData = getCurrentDataCompareToolItems();
                localStorage.setItem(localStorageKey, JSON.stringify(compareToolItemsData));
                updateTextAreaContentFromLocalStorage(compareToolItemsData);
                document.getElementById("error-message-container").innerHTML = "";
            };

            const removeCurrentColumn = (htmlElementRemoveButton) => {
                htmlElementRemoveButton.parentElement.parentElement.remove();
                saveToLocalStorage();
            };

            const getHtmlStringInputItemRow = (currentItemRowPlusButtonIndex, itemColumnValue = "value") => `<input data-current-input-index="${currentItemRowPlusButtonIndex}" onkeydown="changeThisCurrentItemColumnValueOnKeyDown(event)" onfocusout="changeThisCurrentItemColumnValueOnBlur(event)" type="text" placeholder="${itemColumnValue}" style="text-align: center; width: 100%; border: 1px solid #ccc; outline: none; padding: 4px;" />`;

            const addNewItemColumnValueForCurrentRow = (htmlElementPlusButton) => {
                const currentItemRowPlusButtonIndex = ((!htmlElementPlusButton.parentElement.parentElement.dataset["currentItemRowPlusButtonIndex"]) ? 0 : parseInt(htmlElementPlusButton.parentElement.parentElement.dataset["currentItemRowPlusButtonIndex"], 10) + 1);
                htmlElementPlusButton.parentElement.parentElement.dataset["currentItemRowPlusButtonIndex"] = currentItemRowPlusButtonIndex;
                htmlElementPlusButton.parentElement.insertAdjacentHTML("beforebegin", getHtmlStringInputItemRow(currentItemRowPlusButtonIndex));
                htmlElementPlusButton.parentElement.previousElementSibling.focus();
                // htmlElementPlusButton.parentElement.parentElement.dataset["currentItemColumnValues"] = ((htmlElementPlusButton.parentElement.parentElement.dataset["currentItemColumnValues"].trim() === "") ? "0" : `${htmlElementPlusButton.parentElement.parentElement.dataset["currentItemColumnValues"]}, 0`);
            };

            const changeCurrentItemColumnValues = (event) => {
                const inputElement = event.target;
                const currentInputIndex = parseInt(inputElement.dataset["currentInputIndex"], 10);
                if (inputElement.value === "remove(this)") {
                    if (inputElement.parentElement.dataset["currentItemColumnValues"].split(", ")[currentInputIndex] !== undefined) {
                        inputElement.parentElement.dataset["currentItemColumnValues"] = inputElement.parentElement.dataset["currentItemColumnValues"].split(", ").toSpliced(currentInputIndex, 1).join(", ");
                    }
                    inputElement.value = "";
                    inputElement.remove();

                    saveToLocalStorage();
                    return;
                }
                if (inputElement.parentElement.dataset["currentItemColumnValues"].trim() === "") {
                    inputElement.parentElement.dataset["currentItemColumnValues"] = inputElement.value;
                } else if (inputElement.parentElement.dataset["currentItemColumnValues"].split(", ")[currentInputIndex] !== undefined) {
                    inputElement.parentElement.dataset["currentItemColumnValues"] = inputElement.parentElement.dataset["currentItemColumnValues"].split(", ").map((itemColumnValue, itemRowIndex) => ((itemRowIndex === currentInputIndex) ? inputElement.value : itemColumnValue)).join(", ");
                } else {
                    inputElement.parentElement.dataset["currentItemColumnValues"] += (", " + inputElement.value);
                }
                inputElement.placeholder = inputElement.value;
                inputElement.value = "";

                saveToLocalStorage();
            };

            const changeThisCurrentItemColumnValueOnKeyDown = (event) => {
                if (event.key === "Enter") {
                    if (event.target.value.trim() === "") {
                        event.preventDefault();
                        return;
                    }
                    changeCurrentItemColumnValues(event);
                    event.preventDefault();
                }
            };

            const changeThisCurrentItemColumnValueOnBlur = (event) => {
                if (event.target.value.trim() === "") {
                    event.preventDefault();
                    return;
                }
                changeCurrentItemColumnValues(event);
                event.preventDefault();
            };

            const getHtmlStringItemRow = (itemColumnKey = "column key", { columnColor = "", itemColumnValues = "", plusButtonIndex = "", siblings = "", itemColumnKeyPlaceholder = "column key" } = {}) => (`<div data-item-column-key="${itemColumnKey}" data-current-item-column-values="${itemColumnValues}" data-current-item-row-plus-button-index="${plusButtonIndex}" style="box-sizing: border-box; display: flex; flex-direction: row; flex-wrap: wrap; min-width: 200px; max-width: 200px; justify-content: flex-end; align-items: center; padding: 8px; gap: 8px; background-color: ${columnColor};">
    <div style="width: 100%; display: flex; flex-direction: row; justify-content: space-between; align-items: center;">
        <div style="display: flex; flex-direction: row; justify-content: flex-start; align-items: center; column-gap: 8px;">
            <button onclick="moveThisSelectedColumnToLeft(this)" style="background-color: #007bff; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">◀</button>
            <button onclick="moveThisSelectedColumnToRight(this)" style="background-color: #007bff; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">▶</button>
        </div>
        <button onclick="setThisSelectedColumnAsSelectedColumn(this)" style="background-color: #666; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">sel</button>
        <button onclick="removeCurrentColumn(this)" style="background-color: red; color: white; border: none; cursor: pointer; width: 2.1em; aspect-ratio: 1 / 1;">x</button>
    </div>
    <input onkeydown="changeCurrentItemColumnKeyOnKeyDown(event)" onfocusout="changeCurrentItemColumnKeyOnBlur(event)" type="text" placeholder="${itemColumnKeyPlaceholder}" style="text-align: center; width: 100%; border: 1px solid #ccc; outline: none; padding: 4px; font-weight: bold;" />
    ${siblings}
    <div style="display: flex; flex-direction: column; flex: 1; justify-content: center; align-items: center; border: 1px solid #000;">
        <button onclick="addNewItemColumnValueForCurrentRow(this)" style="background-color: #007bff; color: white; border: none; cursor: pointer; width: 100%;">+ value</button>
    </div>
</div>`);

            const setThisSelectedColumnAsSelectedColumn = (htmlElementCheckboxToggleButton) => {
                const currentColumn = htmlElementCheckboxToggleButton.parentElement.parentElement;
                const currentItemColumnKey = currentColumn.dataset["itemColumnKey"];
                const elementHtmlCountainerSelectedColumn = document.getElementById("countainer-selected-column");
                if (elementHtmlCountainerSelectedColumn.dataset["selectedColumn"] === currentItemColumnKey) {
                    elementHtmlCountainerSelectedColumn.removeAttribute("data-selected-column");
                    elementHtmlCountainerSelectedColumn.innerHTML = "";
                    elementHtmlCountainerSelectedColumn.parentElement.parentElement.style.backgroundColor = "#fff";
                    return;
                }
                elementHtmlCountainerSelectedColumn.dataset["selectedColumn"] = currentItemColumnKey;
                elementHtmlCountainerSelectedColumn.innerHTML = currentItemColumnKey;
                elementHtmlCountainerSelectedColumn.parentElement.parentElement.style.backgroundColor = utils.stringToRgbHexColor(currentItemColumnKey);
            };

            const moveSelectedColumnToLeft = () => {
                const elementHtmlCountainerSelectedColumn = document.getElementById("countainer-selected-column");
                const currentItemColumnKey = elementHtmlCountainerSelectedColumn.dataset["selectedColumn"];
                if (!currentItemColumnKey) return;
                const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                const childrenArrayCompareToolItems = Array.from(elementContainerCompareToolItems.children);
                const currentColumnIndex = childrenArrayCompareToolItems.findIndex((columnItem) => (columnItem.dataset["itemColumnKey"] === currentItemColumnKey));
                const currentColumn = elementContainerCompareToolItems.children[currentColumnIndex];

                if (currentColumnIndex === 0) return;
                elementContainerCompareToolItems.insertBefore(currentColumn, elementContainerCompareToolItems.children[currentColumnIndex - 1]);
                saveToLocalStorage();
            };

            const moveSelectedColumnToRight = () => {
                const elementHtmlCountainerSelectedColumn = document.getElementById("countainer-selected-column");
                const currentItemColumnKey = elementHtmlCountainerSelectedColumn.dataset["selectedColumn"];
                if (!currentItemColumnKey) return;
                const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                const childrenArrayCompareToolItems = Array.from(elementContainerCompareToolItems.children);
                const currentColumnIndex = childrenArrayCompareToolItems.findIndex((columnItem) => (columnItem.dataset["itemColumnKey"] === currentItemColumnKey));
                const currentColumn = elementContainerCompareToolItems.children[currentColumnIndex];

                if (currentColumnIndex === (childrenArrayCompareToolItems.length - 1)) return;
                elementContainerCompareToolItems.insertBefore(currentColumn, elementContainerCompareToolItems.children[(currentColumnIndex + 2)]);
                saveToLocalStorage();
            };

            const moveThisSelectedColumnToLeft = (htmlElementMoveToLeftButton) => {
                const currentColumn = htmlElementMoveToLeftButton.parentElement.parentElement.parentElement;
                
                const currentItemColumnKey = currentColumn.dataset["itemColumnKey"];
                const elementContainerCompareToolItems = currentColumn.parentElement;
                const childrenArrayCompareToolItems = Array.from(elementContainerCompareToolItems.children);
                const currentColumnIndex = childrenArrayCompareToolItems.findIndex((columnItem) => (columnItem.dataset["itemColumnKey"] === currentItemColumnKey));

                if (currentColumnIndex === 0) return;
                elementContainerCompareToolItems.insertBefore(currentColumn, elementContainerCompareToolItems.children[currentColumnIndex - 1]);
                saveToLocalStorage();
            };

            const moveThisSelectedColumnToRight = (htmlElementMoveToRightButton) => {
                const currentColumn = htmlElementMoveToRightButton.parentElement.parentElement.parentElement;

                const currentItemColumnKey = currentColumn.dataset["itemColumnKey"];
                const elementContainerCompareToolItems = currentColumn.parentElement;
                const childrenArrayCompareToolItems = Array.from(elementContainerCompareToolItems.children);
                const currentColumnIndex = childrenArrayCompareToolItems.findIndex((columnItem) => (columnItem.dataset["itemColumnKey"] === currentItemColumnKey));

                if (currentColumnIndex === (childrenArrayCompareToolItems.length - 1)) return;
                elementContainerCompareToolItems.insertBefore(currentColumn, elementContainerCompareToolItems.children[(currentColumnIndex + 2)]);
                saveToLocalStorage();
            };

            const changeCurrentItemColumnKey = (event) => {
                const inputElement = event.target;
                const compareToolItemsData = getCurrentDataCompareToolItems();
                if (inputElement.value.includes(",")) {
                    const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                    const newItemColumnKeys = inputElement.value.split(",").reduce((currentResult, itemColumnKey) => {
                        if (compareToolItemsData.some((compareToolItem) => (compareToolItem["item_column_key"] === itemColumnKey.trim())) === true) return currentResult;
                        currentResult.push(itemColumnKey.trim());
                        return currentResult;
                    }, []);
                    elementContainerCompareToolItems.removeChild(elementContainerCompareToolItems.lastChild);
                    elementContainerCompareToolItems.innerHTML += newItemColumnKeys.map((itemColumnKey) => getHtmlStringItemRow(itemColumnKey, { columnColor: utils.stringToRgbHexColor(itemColumnKey), itemColumnKeyPlaceholder: itemColumnKey })).join("");
                    inputElement.value = "";
                    saveToLocalStorage();
                    return;
                }
                if (compareToolItemsData.some((compareToolItem) => (compareToolItem["item_column_key"] === inputElement.value.trim())) === true) {
                    inputElement.value = "";
                    inputElement.parentElement.remove();
                    return;
                }
                inputElement.parentElement.dataset["itemColumnKey"] = inputElement.value.trim();
                inputElement.parentElement.style.backgroundColor = utils.stringToRgbHexColor(inputElement.value.trim());
                inputElement.placeholder = inputElement.value.trim();
                inputElement.value = "";
                saveToLocalStorage();
            };

            const changeCurrentItemColumnKeyOnKeyDown = (event) => {
                if (event.key === "Enter") {
                    if (event.target.value.trim() === "") {
                        event.preventDefault();
                        return;
                    }
                    try {
                        changeCurrentItemColumnKey(event);
                    } catch (err) {
                        // false alarm error | ignored error
                    }
                    event.preventDefault();
                }
            };

            const changeCurrentItemColumnKeyOnBlur = (event) => {
                if (event.target.value.trim() === "") {
                    event.preventDefault();
                    return;
                }
                try {
                    changeCurrentItemColumnKey(event);
                } catch (err) {
                    // false alarm error | ignored error
                }
                event.preventDefault();
            };

            const addNewColumnKey = () => {
                const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                elementContainerCompareToolItems.innerHTML += getHtmlStringItemRow();
                elementContainerCompareToolItems.lastElementChild.querySelector('input[type="text"]').focus();
            };

            const rerenderCompareTool = (compareToolItemsData) => {
                const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                elementContainerCompareToolItems.innerHTML = compareToolItemsData.map((itemCompareTool) => {
                    const arrayItemColumnValues = itemCompareTool["item_column_values"].split(", ");
                    return getHtmlStringItemRow(itemCompareTool["item_column_key"], {
                        columnColor: utils.stringToRgbHexColor(itemCompareTool["item_column_key"]),
                        itemColumnValues: itemCompareTool["item_column_values"],
                        plusButtonIndex: `${((arrayItemColumnValues.length === undefined) ? 0 : (arrayItemColumnValues.length - 1))}`,
                        siblings: arrayItemColumnValues.map((currentItemColumnValue, currentItemRowPlusButtonIndex) => getHtmlStringInputItemRow(currentItemRowPlusButtonIndex, ((currentItemColumnValue.trim() === "") ? "value" : currentItemColumnValue))).join(""),
                        itemColumnKeyPlaceholder: itemCompareTool["item_column_key"],
                    })}).join("");
            };

            const loadFromLocalStorage = () => {
                const savedDataCompareTool = JSON.parse(localStorage.getItem(localStorageKey));
                if (savedDataCompareTool === null) return;
                updateTextAreaContentFromLocalStorage(savedDataCompareTool);
                rerenderCompareTool(savedDataCompareTool);
            };

            const updateTextAreaContentToLocalStorage = (event) => {
                const elementImportExportTextareaElementCompareTool = event.target;
                const elementImportExportTextareaElementCompareToolValue = elementImportExportTextareaElementCompareTool.value;
                try {
                    const compareToolItemsData = JSON.parse(elementImportExportTextareaElementCompareToolValue);
                    const compareToolItemsDataUniqueKey = utils.removeDuplicateItem(compareToolItemsData, (anyArrayItem) => anyArrayItem["item_column_key"]);
                    // console.log(elementImportExportTextareaElementCompareToolValue);
                    // console.log(JSON.stringify(compareToolItemsData));
                    // console.log(JSON.stringify(compareToolItemsDataUniqueKey));
                    localStorage.setItem(localStorageKey, JSON.stringify(compareToolItemsDataUniqueKey));
                    rerenderCompareTool(compareToolItemsDataUniqueKey);
                } catch (anyError) {
                    document.getElementById("error-message-container").innerHTML = (`<p style="color: red;">Format backup-an yang di-restore tidak sesuai.</p>`);
                }
            };

            const updateTextAreaContentToLocalStorageOnBlur = (event) => {
                if (event.target.value.trim() === "") {
                    localStorage.removeItem(localStorageKey);
                    const elementContainerCompareToolItems = document.getElementById("compare-tool-items-container");
                    elementContainerCompareToolItems.innerHTML = "";
                    event.preventDefault();
                    return;
                }
                updateTextAreaContentToLocalStorage(event);
                // loadFromLocalStorage();
                event.preventDefault();
            };

            loadFromLocalStorage();
        </script>
    </body>
</html>
